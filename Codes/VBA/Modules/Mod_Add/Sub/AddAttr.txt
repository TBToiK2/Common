'----------------------------------------------------------------------------------------------------
'2021/11/10 22:19:50
'----------------------------------------------------------------------------------------------------
'参照設定:Microsoft Scripting Runtime
'ProgID:Scripting.FileSystemObject
'CLSID:{0D43FE01-F093-11CF-8940-00A0C9054228}
'Name:Scripting
'FullPath:C:\Windows\System32\scrrun.dll
'Major.Minor:1.0
Public Sub AddAttr(ByVal Spec As String, ByVal Attr As FileAttribute)
On Error GoTo Err

    Dim FSO As New FileSystemObject

    Dim AfterAttr As FileAttribute

    '属性 比較(ビット演算)
    If GetAttr(Spec) And vbDirectory = vbDirectory Then

        Dim AttrFolder As Folder
        Set AttrFolder = GetFolder(Spec)
        'フォルダ属性 比較(ビット演算)
        AfterAttr = AttrFolder.Attributes Or Attr
        AttrFolder.Attributes = AfterAttr

    Else

        Dim AttrFile As File
        Set AttrFile = GetFile(Spec)
        'ファイル属性 比較(ビット演算)
        AfterAttr = GetFile(Spec).Attributes Or Attr
        AttrFile.Attributes = AfterAttr

    End If

    Exit Sub

'エラー処理
Err:

    Call ShowErrMsg(Err.Description, Err.Number)

End Sub
'----------------------------------------------------------------------------------------------------