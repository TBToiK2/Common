'----------------------------------------------------------------------------------------------------
'2022/03/15 02:06:24
'----------------------------------------------------------------------------------------------------
Public Function IsOpen(ByVal fileSpec As String) As Long
On Error Resume Next

    Dim fileNumber As Long
    fileNumber = FreeFile(0)

    'ファイルナンバー1-255 使用時
    If fileNumber = 0 Then fileNumber = FreeFile(1)

    'ファイルナンバー256-512 使用時
    If fileNumber = 0 Then
        IsOpen = 1
    Else
        '開閉確認
        Open fileSpec For Append As #fileNumber
        Close #fileNumber

        IsOpen = Err.Number = 55

    End If

End Function
'----------------------------------------------------------------------------------------------------