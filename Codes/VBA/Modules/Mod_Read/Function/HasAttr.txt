'----------------------------------------------------------------------------------------------------
'2022/03/20 00:06:50
'----------------------------------------------------------------------------------------------------
'参照設定:Microsoft Scripting Runtime
'ProgID:Scripting.FileSystemObject
'CLSID:{0D43FE01-F093-11CF-8940-00A0C9054228}
'LibraryName:Scripting
'FullPath:C:\Windows\System32\scrrun.dll
'Major.Minor:1.0
Public Function HasAttr(ByVal spec As String, ByVal attr As FileAttribute) As Boolean
On Error GoTo Err

    Dim FSO As New FileSystemObject
    With FSO

        '属性 比較(ビット演算)
        If (GetAttr(spec) And vbDirectory) = vbDirectory Then

            'フォルダ属性 比較(ビット演算)
            HasAttr = (.GetFolder(spec).Attributes And attr) = attr

        Else
            'ファイル属性 比較(ビット演算)
            HasAttr = (.GetFile(spec).Attributes And attr) = attr

        End If

    End With

    Exit Function

'エラー処理
Err:

    Call ShowErrMsg(Err.Description, Err.Number, "HasAttr")

End Function
'----------------------------------------------------------------------------------------------------