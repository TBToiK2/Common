'----------------------------------------------------------------------------------------------------
'2022/03/20 00:06:50
'----------------------------------------------------------------------------------------------------
'参照設定:Microsoft VBScript Regular Explession 5.5
'ProgID:VBScript.RegExp
'CLSID:{3F4DACA4-160D-11D2-A8E9-00104B365C9F}
'LibraryName:VBScript_RegExp_55
'FullPath:C:\Windows\System32\vbscript.dll\3
'Major.Minor:5.5
Public Function IsNumber(ByVal Expression As Variant) As Boolean
On Error GoTo Err

    '空判定
    If IsBlank(Expression) Then Exit Function

    '正規表現 判定
    Dim Reg As New RegExp
    With Reg
        .Global = False
        .IgnoreCase = False
        .MultiLine = False
        .Pattern = "^(?:(?!-0$)|-?\d+)(?:\.\d*?[1-9])?$"
        IsNumber = .Test(Expression)
    End With

    Exit Function

'エラー処理
Err:

    Call ShowErrMsg(Err.Description, Err.Number, "IsNumber")

End Function
'----------------------------------------------------------------------------------------------------