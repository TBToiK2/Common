'----------------------------------------------------------------------------------------------------
Private Sub Btn_ChangeFPath_Click()
On Error Resume Next

    'シート 選択判定
    Dim Path As String
    If IsBlank(g_ParamShName) Then
        Call ShowErrMsg("対象シートが選択されていません。" & vbCrLf & "シートを選択してください。")
        Exit Sub
    Else
        Path = GetPath(Lbl_FPath.Caption)
        If Not FolderExists(Path) Then Path = ThisWorkbook.Path
    End If

    'カレントドライブ・ディレクトリ 初期化
    If Left(Path, 2) = "\\" Then
        CreateObject("WScript.Shell").CurrentDirectory = Path
    Else
        Call ChDrive(Path)
        Call ChDir(Path)
    End If

    If Err.Number > 0 Then
        Path = ThisWorkbook.Path
        'カレントドライブ・ディレクトリ 初期化
        If Left(Path, 2) = "\\" Then
            CreateObject("WScript.Shell").CurrentDirectory = Path
        Else
            Call ChDrive(Path)
            Call ChDir(Path)
        End If
    End If

    '選択ファイル名 取得
    Dim FileSpec As String
    FileSpec = GetSelectFileSpec()

    'ファイル 選択判定
    If Not IsBlank(FileSpec) Then
        '選択ファイル名 反映
        Lbl_FPath.Caption = FileSpec
        ThisWorkbook.Sheets(g_ParamShName).Range("C13").Value = FileSpec
    End If

End Sub
'----------------------------------------------------------------------------------------------------