'----------------------------------------------------------------------------------------------------
Private Sub UserForm_Initialize()
On Error GoTo Err

    'フォームキャプション 設定
    With Main
        Frm_Main.Caption = .Cells(1, 1).Value & .Cells(4, 22).Value
    End With

    Dim ThisWorksheets As Worksheets
    Set ThisWorksheets = ThisWorkbook.Worksheets
    'シート有無 確認
    If Not HasWorksheet(ThisWorksheets, "Main") Then
        Call ShowErrMsg("コピーツール内に実行シートが存在しません。")
        End
    End If

    'コンボボックス 値追加
    Dim ws As Worksheet
    For Each ws In ThisWorksheets
        If ws.Name <> "Main" And ws.Name <> "Template" Then
            Cmb_ShName.AddItem ws.Name
        End If
    Next ws

    'バックグラウンドモード 初期化
    Ckb_Background.Value = False

    Exit Sub

'エラー処理
Err:

    Call ShowErrMsg(Err.Description, Err.Number)

    'フォーム 終了
    Unload Me

End Sub
'----------------------------------------------------------------------------------------------------